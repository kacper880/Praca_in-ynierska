Rozdział 2
Pozyskiwanie dźwięku

W Androidzie do pozyskiwania dźwięku jak i video służy nam klasa MediaRecorder. Do obsłużenia klasy potrzebne jest wywołanie odpowiednich metod w określonej kolejności, tak aby uniknąć wystąpienia wyjątku IllegalStateException. Na początku musimy zadeklarować obiekt klasy MediaRecorder. Posłuży on nam do wszelkich operacji typu ustawienie ścieżki, źródła dźwięku itp. Zanim zaczniemy implementować wszelkie metody, służące do pozyskiwania dźwięku, musimy ustawić w pliku AndroidManifest.xml dostęp do zasobów w telefonie. I tak jeśli chcemy nagrywać potrzebujemy nadać odpowiednie uprawnienie zezwalające na nagrywanie (RECORD_AUDIO). Jednocześnie nagraną próbkę chcielibyśmy zapisać na karcie telefonu. Do tego potrzebujemy zadeklarować uprawnienie do zapisywania (WRITE_EXTERNAL_STORAGE). W następnych akapitach przedstawię pokrótce zasadę procesów nagrywania i zakończenia nagrywania. 
Metody do nagrywania dźwięku umiejscowimy w funkcji „rozpocznij_nagrywanie()” , która następnie wywołamy po naciśnięciu przycisku „nagraj”. Przejdżmy do funkcji obsługującej nagrywanie. Zanim zaczniemy przechwytywać jakikolwiek dźwięk musimy sprawdzić czy wcześniej zadeklarowany obiekt nie jest zajęty. Wykorzystamy do tego metodę „release()”, która zwalnia wszelkie zasoby w obiekcie. Aby nie nadpisywać zawartości pliku na początku sprawdzamy czy dany plik już istnieje. Jeśli tak to kasujemy go wraz z zawartością i tworzymy nowy o tej samej nazwie .Po pierwsze inicjujemy obiekt klasy MediaRecorder. Za pomocą nowo stworzonego obiektu ustawiamy źródło dźwięku „setAudioSource”. Jako parametr przyjmujemy mikrofon.  Aby go obsłużyć po kolej wywołujemy wspomnianą klasę, następnie metodę przedstawiającą źródło dźwięku „AudioSource”. Ostatnim elementem jest wskazanie jakie to jest źródło. W naszym przypadku jest to mikrofon.  Kolejnym elementem jest ustawienie formatu wyjściowego, czyli w jakim formacie zostanie przedstawiony nasz nagrany dźwięk. Jako parametr ustawiamy „THREE_GP”.  Następnie ustawiamy „ setAudioEncoder”  określamy koder audio „AMR.NB”.  Ostatnią metodę którą powinniśmy wywołać , to wskazanie, gdzie nagrana próbka dźwięku zostanie zapisana. Jest to „setOutputFile”  i jako parametr podajemy String w którym określamy ścieżkę gdzie ma zostać zapisany plik metoda „getExternalStorageDirectory()” i nazwę pliku wraz z rozszerzeniem (3gpp). W momencie, gdy obsłużymy wyżej wymienione metody, pozostaje nam przygotowanie obiektu do nagrywania (metoda prepare()) i ostatecznie wywołanie procedury nagrywania za pomocą metody „start()”.
Jeśli nagraliśmy pewną próbkę dźwięku należałoby wskazać, w którym miejscu następuje skończenie procesu nagrywania. Wykorzystamy do tego funkcję „zakoncz_nag()” ,w której sprawdzamy czy obiekt klasy MediaRecorder nie jest pusty.  Jeśli wynik zapytania jest pozytywny to wywołujemy metodę „stop()”, będąca zakończeniem wykonywanego procesu.  Na końcu został jeszcze zastosowany proces powiadamiający użytkownika w momencie wywołania funkcji o tym, że proces nagrywania właśnie się zakończył.
W następnym dziale zostanie przedstawiona klasa wraz z odpowiednimi metodami, pozwalająca na odtworzenie nagranego dźwięku. 

	
